<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weather Dashboard (India)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to bottom right, #3a7bd5, #00d2ff);
      color: white;
      text-align: center;
      padding: 20px;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 10px;
      padding: 20px;
    }
    input {
      padding: 10px;
      width: 70%;
      border-radius: 5px;
      border: none;
      outline: none;
      margin-bottom: 10px;
    }
    button {
      padding: 10px 15px;
      border: none;
      border-radius: 5px;
      background: #ffb703;
      color: #000;
      cursor: pointer;
      font-weight: bold;
    }
    button:hover {
      background: #ffca3a;
    }
    .forecast {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      margin-top: 15px;
    }
    .day {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      padding: 10px;
      margin: 5px;
      width: 100px;
    }
    .tests {
      margin-top: 20px;
      text-align: left;
      font-size: 14px;
      background: rgba(0,0,0,0.4);
      padding: 10px;
      border-radius: 5px;
    }
  </style>
</head>
<body>

  <div class="container">
    <h1>🇮🇳 Weather Dashboard (Indian Cities)</h1>

    <!-- Search box -->
    <input type="text" id="cityInput" placeholder="Enter Indian city (e.g., Mumbai, Chennai)">
    <button onclick="getWeather()">Search</button>

    <!-- Weather display -->
    <h2 id="cityName">New Delhi</h2>
    <h3 id="temperature">-- °C</h3>
    <p id="description">--</p>

    <h3>5-Day Forecast</h3>
    <div id="forecast" class="forecast"></div>

    <!-- JS function testing -->
    <div class="tests">
      <h3>JS Test Results</h3>
      <button onclick="runTests()">Run JS Tests</button>
      <pre id="testResults"></pre>
    </div>
  </div>

  <script>
    const API_KEY = "YOUR_API_KEY_HERE";  // Replace with your OpenWeatherMap key
    const DEFAULT_CITY = "New Delhi";      // Fixed city for version 1

    // Load default city on page load
    window.onload = () => getWeather(DEFAULT_CITY);

    // Fetch weather for city
    async function getWeather(cityName) {
      const city = cityName || document.getElementById("cityInput").value || DEFAULT_CITY;
      const currentURL = `https://api.openweathermap.org/data/2.5/weather?q=${city},IN&units=metric&appid=${API_KEY}`;
      const forecastURL = `https://api.openweathermap.org/data/2.5/forecast?q=${city},IN&units=metric&appid=${API_KEY}`;

      try {
        // Current weather
        const currentRes = await fetch(currentURL);
        const currentData = await currentRes.json();

        document.getElementById("cityName").textContent = currentData.name;
        document.getElementById("temperature").textContent = `${currentData.main.temp} °C`;
        document.getElementById("description").textContent = currentData.weather[0].description;

        // Forecast data
        const forecastRes = await fetch(forecastURL);
        const forecastData = await forecastRes.json();
        displayForecast(forecastData.list);
      } catch (err) {
        alert("Error fetching weather data. Check your API key or city name.");
        console.error(err);
      }
    }

    // Display 5-day forecast (12:00:00 each day)
    function displayForecast(list) {
      const forecastDiv = document.getElementById("forecast");
      forecastDiv.innerHTML = "";
      const daily = list.filter(item => item.dt_txt.includes("12:00:00"));

      daily.slice(0, 5).forEach(day => {
        const date = new Date(day.dt * 1000);
        const element = document.createElement("div");
        element.className = "day";
        element.innerHTML = `
          <strong>${date.toDateString().slice(0, 10)}</strong><br>
          🌡️ ${day.main.temp}°C<br>
          ☁️ ${day.weather[0].main}
        `;
        forecastDiv.appendChild(element);
      });
    }

    // JS Test Functions
    function runTests() {
      const out = document.getElementById("testResults");
      out.textContent = "";

      function cToF(c) { return (c * 9/5) + 32; }
      function fToC(f) { return (f - 32) * 5/9; }

      try {
        out.textContent += "Temperature Conversion Tests:\n";
        out.textContent += `25°C → ${cToF(25).toFixed(2)}°F\n`;
        out.textContent += `77°F → ${fToC(77).toFixed(2)}°C\n`;

        out.textContent += "\nAPI URL Tests:\n";
        const testCity = "Mumbai";
        const url = `https://api.openweathermap.org/data/2.5/weather?q=${testCity},IN&units=metric&appid=${API_KEY}`;
        out.textContent += `API URL generated correctly: ${url}\n✅ All tests passed.`;
      } catch (e) {
        out.textContent += "❌ Error in tests: " + e.message;
      }
    }
  </script>

</body>
</html>
